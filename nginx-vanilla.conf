# Número de procesos de Nginx que se ejecutan.
# Para un servidor local o educativo, 1 proceso es suficiente.
worker_processes 1;

events {
  # Número máximo de conexiones simultáneas que puede manejar.
  # 1024 es más que suficiente en un entorno de desarrollo.
  worker_connections 1024;
}

http {
  # Cargamos la lista de tipos MIME para servir correctamente
  # archivos .html, .css, .js, imágenes, fuentes, etc.
  include       /etc/nginx/mime.types;

  # Tipo por defecto si la extensión no se reconoce.
  default_type  application/octet-stream;

  # Optimiza la lectura y envío de archivos estáticos.
  sendfile        on;

  # Tiempo que Nginx mantiene una conexión abierta antes de cerrarla.
  keepalive_timeout  65;

  server {
    # El servidor escucha en el puerto 80 dentro del contenedor.
    listen 80;

    # Carpeta raíz donde Nginx buscará los archivos estáticos.
    # En tu docker-compose montas aquí ./vanilla-sites u otra carpeta.
    root /usr/share/nginx/html;

    # Configuración para la ruta principal ("/").
    location / {

      # Activa el listado automático de archivos y carpetas.
      # Muy útil para navegar por múltiples ejercicios o apps
      # dentro de la misma carpeta sin configurar rutas distintas.
      autoindex on;

      # Orden de búsqueda cuando se solicita una ruta:
      # 1) $uri     → intentar servir un archivo exacto
      # 2) $uri/    → intentar servir una carpeta
      # 3) =404     → si no existe, devolver un error 404
      #
      # IMPORTANTE:
      # Esto funciona perfectamente para HTML/JS estático,
      # pero NO para aplicaciones SPA como Angular o React,
      # porque no redirige rutas internas a index.html.
      try_files $uri $uri/ =404;
    }
  }
}
