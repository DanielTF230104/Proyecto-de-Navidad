{"ast":null,"code":"import { signal, computed, inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AccesoApiService } from './acceso-api.service';\nimport { HttpClient } from '@angular/common/http'; // Importa HttpClient\nimport * as i0 from \"@angular/core\";\nexport class AuthService {\n  constructor() {\n    this.http = inject(HttpClient);\n    this.accesoApi = inject(AccesoApiService);\n    this.router = inject(Router);\n    this._isLoggedIn = signal(false);\n    this.isLoggedIn = this._isLoggedIn.asReadonly();\n    this._usuario = signal(null);\n    this.usuario = this._usuario.asReadonly();\n    // Requisito 1: Signal computado para saber si es Admin\n    // Signal que detecta si el usuario es admin\n    this.isAdmin = computed(() => this._usuario()?.rol === 'administrador');\n  }\n  login(username, password) {\n    return this.http.post('http://localhost:3000/usuarios/login', {\n      username,\n      password\n    }).pipe(tap(res => {\n      if (res.ok) {\n        this.usuario.set(res.usuario);\n        this.isLoggedIn.set(true);\n        this.isAdmin.set(res.usuario.rol === 'admin');\n      }\n    }));\n  }\n  // Quitamos 'rol' de los argumentos de la función principal\n  registro(nombre, username, pass, imagen, rol) {\n    const body = {\n      nombre,\n      username,\n      pass,\n      imagen,\n      rol\n    };\n    // Eliminamos los \"...\" y simplemente retornamos el observable\n    return this.http.post('http://localhost:3000/usuarios/grabar', body);\n  }\n  logout() {\n    this._isLoggedIn.set(false);\n    this._usuario.set(null);\n    localStorage.clear();\n    this.router.navigate(['/login']);\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["signal","computed","inject","Router","AccesoApiService","HttpClient","AuthService","constructor","http","accesoApi","router","_isLoggedIn","isLoggedIn","asReadonly","_usuario","usuario","isAdmin","rol","login","username","password","post","pipe","tap","res","ok","set","registro","nombre","pass","imagen","body","logout","localStorage","clear","navigate","factory","ɵfac","providedIn"],"sources":["/usr/src/app/PROYECTO_NAVIDAD/PROYECTO_NAVIDAD/src/app/servicios/auth.service.ts"],"sourcesContent":["import { Injectable, signal, computed, inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AccesoApiService } from './acceso-api.service';\nimport { HttpClient } from '@angular/common/http'; // Importa HttpClient\n\n@Injectable({ providedIn: 'root' })\nexport class AuthService {\n  private http = inject(HttpClient);\n  private accesoApi = inject(AccesoApiService);\n  private router = inject(Router);\n\n  private _isLoggedIn = signal(false);\n  isLoggedIn = this._isLoggedIn.asReadonly();\n\n  public _usuario = signal<any | null>(null);\n  usuario = this._usuario.asReadonly();\n\n  // Requisito 1: Signal computado para saber si es Admin\n  // Signal que detecta si el usuario es admin\n  public isAdmin = computed(() => this._usuario()?.rol === 'administrador');\n  login(username: string, password: string): Observable<any> {\n  return this.http.post<any>('http://localhost:3000/usuarios/login', { username, password })\n    .pipe(\n      tap(res => {\n        if (res.ok) {\n          this.usuario.set(res.usuario);\n          this.isLoggedIn.set(true);\n          this.isAdmin.set(res.usuario.rol === 'admin');\n        }\n      })\n    );\n}\n\n  // Quitamos 'rol' de los argumentos de la función principal\n  registro(nombre: string, username: string, pass: string, imagen: string, rol: string) {\n    const body = { nombre, username, pass, imagen, rol };\n    // Eliminamos los \"...\" y simplemente retornamos el observable\n    return this.http.post('http://localhost:3000/usuarios/grabar', body);\n}\n\n  logout(): void {\n    this._isLoggedIn.set(false);\n    this._usuario.set(null);\n    localStorage.clear();\n    this.router.navigate(['/login']);\n  }\n}"],"mappings":"AAAA,SAAqBA,MAAM,EAAEC,QAAQ,EAAEC,MAAM,QAAQ,eAAe;AACpE,SAASC,MAAM,QAAQ,iBAAiB;AACxC,SAASC,gBAAgB,QAAQ,sBAAsB;AACvD,SAASC,UAAU,QAAQ,sBAAsB,CAAC,CAAC;;AAGnD,OAAM,MAAOC,WAAW;EADxBC,YAAA;IAEU,KAAAC,IAAI,GAAGN,MAAM,CAACG,UAAU,CAAC;IACzB,KAAAI,SAAS,GAAGP,MAAM,CAACE,gBAAgB,CAAC;IACpC,KAAAM,MAAM,GAAGR,MAAM,CAACC,MAAM,CAAC;IAEvB,KAAAQ,WAAW,GAAGX,MAAM,CAAC,KAAK,CAAC;IACnC,KAAAY,UAAU,GAAG,IAAI,CAACD,WAAW,CAACE,UAAU,EAAE;IAEnC,KAAAC,QAAQ,GAAGd,MAAM,CAAa,IAAI,CAAC;IAC1C,KAAAe,OAAO,GAAG,IAAI,CAACD,QAAQ,CAACD,UAAU,EAAE;IAEpC;IACA;IACO,KAAAG,OAAO,GAAGf,QAAQ,CAAC,MAAM,IAAI,CAACa,QAAQ,EAAE,EAAEG,GAAG,KAAK,eAAe,CAAC;;EACzEC,KAAKA,CAACC,QAAgB,EAAEC,QAAgB;IACxC,OAAO,IAAI,CAACZ,IAAI,CAACa,IAAI,CAAM,sCAAsC,EAAE;MAAEF,QAAQ;MAAEC;IAAQ,CAAE,CAAC,CACvFE,IAAI,CACHC,GAAG,CAACC,GAAG,IAAG;MACR,IAAIA,GAAG,CAACC,EAAE,EAAE;QACV,IAAI,CAACV,OAAO,CAACW,GAAG,CAACF,GAAG,CAACT,OAAO,CAAC;QAC7B,IAAI,CAACH,UAAU,CAACc,GAAG,CAAC,IAAI,CAAC;QACzB,IAAI,CAACV,OAAO,CAACU,GAAG,CAACF,GAAG,CAACT,OAAO,CAACE,GAAG,KAAK,OAAO,CAAC;;IAEjD,CAAC,CAAC,CACH;EACL;EAEE;EACAU,QAAQA,CAACC,MAAc,EAAET,QAAgB,EAAEU,IAAY,EAAEC,MAAc,EAAEb,GAAW;IAClF,MAAMc,IAAI,GAAG;MAAEH,MAAM;MAAET,QAAQ;MAAEU,IAAI;MAAEC,MAAM;MAAEb;IAAG,CAAE;IACpD;IACA,OAAO,IAAI,CAACT,IAAI,CAACa,IAAI,CAAC,uCAAuC,EAAEU,IAAI,CAAC;EACxE;EAEEC,MAAMA,CAAA;IACJ,IAAI,CAACrB,WAAW,CAACe,GAAG,CAAC,KAAK,CAAC;IAC3B,IAAI,CAACZ,QAAQ,CAACY,GAAG,CAAC,IAAI,CAAC;IACvBO,YAAY,CAACC,KAAK,EAAE;IACpB,IAAI,CAACxB,MAAM,CAACyB,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;EAClC;;;uBAvCW7B,WAAW;IAAA;EAAA;;;aAAXA,WAAW;MAAA8B,OAAA,EAAX9B,WAAW,CAAA+B,IAAA;MAAAC,UAAA,EADE;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}